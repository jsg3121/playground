<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- <script src="../jquery/jquery-3.4.1.min.js"></script> -->
    <link rel="stylesheet" href="../Style/reset.css">
    <style>
        body {
            width: 1200px;
            height: 500px;
            margin: 400px auto 0;
        }

        table thead tr {
            background-color: #ececec;
        }

        th,
        td {
            vertical-align: middle;
            text-align: center;
        }

        table tr {
            height: 30px;
            border: 1px solid #777777;
        }
    </style>
</head>

<body>
    <div class="table_box">
        <table class="table" id="main">
            <thead>
                <tr>
                    <th class="sort">sort</th>
                    <th>title</th>
                    <th class="sort">title</th>
                    <th class="sort">title</th>
                    <th>title</th>
                    <th>title</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>zds</td>
                    <td>ascav</td>
                    <td>xghe</td>
                    <td>vsvew</td>
                    <td>ysdc</td>
                    <td>gase</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>안녕하세요</td>
                    <td>반갑습니다</td>
                    <td>usfntent2</td>
                    <td>usfntent2</td>
                    <td>usfntent2</td>
                </tr>
                <tr>
                    <td>112</td>
                    <td>112tent12</td>
                    <td>112tent12</td>
                    <td>112tent12</td>
                    <td>112tent12</td>
                    <td>112tent12</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>abcke</td>
                    <td>abcke</td>
                    <td>abcke</td>
                    <td>abcke</td>
                    <td>abcke</td>
                </tr>
                <tr>
                    <td>하이염</td>
                    <td>ax</td>
                    <td>hwehs</td>
                    <td>hwehs</td>
                    <td>hwehs</td>
                    <td>hwehs</td>
                </tr>
                <tr>
                    <td>하이염</td>
                    <td>qevz</td>
                    <td>hwehs</td>
                    <td>hwehs</td>
                    <td>hwehs</td>
                    <td>hwehs</td>
                </tr>
                <tr>
                    <td>가나다</td>
                    <td>hwehs</td>
                    <td>hwehs</td>
                    <td>hwehs</td>
                    <td>hwehs</td>
                    <td>hwehs</td>
                </tr>
                <tr>
                    <td>osp</td>
                    <td>ase</td>
                    <td>wdvs</td>
                    <td>hwehs</td>
                    <td>hwehs</td>
                    <td>hwehs</td>
                </tr>
            </tbody>
        </table>
    </div>

    <script>
        // $(document).ready(function() {
        //     $("table thead tr .sort").click(function() {
        //         let idxTitle = $(this).index(),
        //             rowLength = $(this).closest("table").children("tbody").children("tr").length,
        //             colLength = $(this).closest("table").children("thead").children("tr").children("th").length;
        //         let sortArr = Array.from(Array(rowLength), () => new Array(colLength));


        //         for(let i = 0; i < rowLength; i++) {
        //             for(let j = 0; j < colLength; j++) {
        //                 sortArr[i][j] = $(this).closest("table").children("tbody").children("tr").eq(i).children("td").eq(j).text()
        //             }
        //         }

        //         sortArr.sort(function(a, b){
        //             if(a[idxTitle] < b[idxTitle]) return -1;
        //             else if (a[idxTitle] > b[idxTitle]) return 1;
        //             else return 0
        //         })

        //         sortArr.sort(function(a, b){
        //             let typeOf_a = parseInt(a[idxTitle]),
        //                 typeOf_b = parseInt(b[idxTitle])

        //             if(isNaN(typeOf_a)) {
        //                 typeOf_a = a[idxTitle];
        //             }

        //             if(isNaN(typeOf_b)) {
        //                 typeOf_b = b[idxTitle];
        //             }

        //             if(typeOf_a < typeOf_b) return -1;
        //             else if (typeOf_a > typeOf_b) return 1;
        //             else return 0
        //         })

        //         // console.log(sortArr)

        //         // for(let i = 0; i < rowLength; i++) {
        //         //     for(let j = 0; j < colLength; j++) {
        //         //         $(this).closest("table").children("tbody").children("tr").eq(i).children("td").eq(j).text(sortArr[i][j]) 
        //         //     }
        //         // }
        //     })
        // })

        let sortTarget = document.querySelectorAll(".sort")
        sortTarget.forEach(function (e) {
            e.addEventListener("click", function (e) {
                let closestTable = this.closest("table").tagName.toLowerCase(),
                    sortIndex = document.querySelectorAll(closestTable + " thead tr th"),
                    sortIndexNum = [...sortIndex].indexOf(e.target),
                    rowLength = document.querySelectorAll(closestTable + " tbody tr").length,
                    colLength = document.querySelectorAll(closestTable + " tbody tr:nth-child(1) td").length
                // console.log(sortIndexNum)
                let sortArr = Array.from(Array(rowLength), () => new Array(colLength));

                // console.log(this.closest("table").children[1].children[0].children[0].innerText)
                // console.log(sortIndexNum)
                // console.log(rowLength)
                // console.log(colLength)

                
                for (let i = 0; i < rowLength; i++) {
                    for (let j = 0; j < colLength; j++) {
                        sortArr[i][j] = this.closest("table").children[1].children[i].children[j].innerText
                    }
                }

                console.log(sortArr)

                sortArr.sort((a, b) => {
                    if (a[sortIndexNum] < b[sortIndexNum]) return -1;
                    else if (a[sortIndexNum] > b[sortIndexNum]) return 1;
                    else return 0
                })

                sortArr.sort((a, b) => {
                    let typeOf_a = parseInt(a[sortIndexNum]),
                        typeOf_b = parseInt(b[sortIndexNum])

                    if (isNaN(typeOf_a))typeOf_a = a[sortIndexNum];
                    if (isNaN(typeOf_b))typeOf_b = b[sortIndexNum];
                    
                    if (typeOf_a < typeOf_b) return -1;
                    else if (typeOf_a > typeOf_b) return 1;
                    else return 0
                })

                for(let i = 0; i < rowLength; i++) {
                    for(let j = 0; j < colLength; j++) {
                        this.closest("table").children[1].children[i].children[j].innerText = sortArr[i][j]
                    }
                }
            })
        })
    </script>
</body>

</html>